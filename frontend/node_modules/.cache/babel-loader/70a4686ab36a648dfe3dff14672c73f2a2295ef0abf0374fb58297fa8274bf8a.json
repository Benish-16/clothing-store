{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\91600\\\\Documents\\\\zahidproject\\\\frontend\\\\src\\\\context\\\\cart\\\\CartState.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from \"react\";\nimport CartContext from \"./CartContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const CartProvider = ({\n  children\n}) => {\n  _s();\n  const [cartItems, setCartItems] = useState([]);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    fetchCart();\n  }, []);\n  const fetchCart = async () => {\n    try {\n      const res = await fetch(\"http://localhost:5000/api/cart/fetchcart\", {\n        headers: {\n          \"auth-token\": localStorage.getItem(\"token\")\n        }\n      });\n      const data = await res.json();\n      setCartItems(data.items || []);\n    } catch (err) {\n      console.error(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const addToCart = async (item, qty) => {\n    try {\n      // Update frontend state immediately\n      setCartItems(prev => {\n        const existing = prev.find(i => i.product._id === item.productId && i.variant.color === item.color && i.size === item.size);\n        if (existing) {\n          return prev.map(i => i === existing ? {\n            ...i,\n            quantity: i.quantity + qty\n          } : i);\n        } else {\n          return [...prev, {\n            ...item,\n            quantity: qty\n          }];\n        }\n      });\n\n      // Send backend request to persist\n      const res = await fetch(\"http://localhost:5000/api/cart/addcart\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"auth-token\": localStorage.getItem(\"token\")\n        },\n        body: JSON.stringify({\n          productId: item.productId,\n          color: item.color,\n          size: item.size,\n          image: item.image,\n          price: item.price,\n          quantity: qty\n        })\n      });\n      const data = await res.json();\n      if (!data.success) {\n        console.error(\"Failed to add to cart:\", data.message);\n        // Optionally revert state if backend fails\n      }\n    } catch (err) {\n      console.error(err);\n    }\n  };\n  const removeFromCart = async item => {\n    console.log(item.product._id, item.variant.color, item.size);\n    try {\n      const res = await fetch(\"http://localhost:5000/api/cart/removecart\", {\n        method: \"DELETE\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"auth-token\": localStorage.getItem(\"token\")\n        },\n        body: JSON.stringify({\n          productId: item.product._id,\n          color: item.variant.color,\n          size: item.size,\n          quantity: item.qunatity\n        })\n      });\n      const data = await res.json();\n      if (data.success) {\n        setCartItems(data.cart.items);\n      }\n    } catch (err) {\n      console.error(err);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(CartContext.Provider, {\n    value: {\n      cartItems,\n      setCartItems,\n      loading,\n      addToCart,\n      removeFromCart\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 5\n  }, this);\n};\n_s(CartProvider, \"cilFcC1AIWylMAcpxsY9xFoPL/k=\");\n_c = CartProvider;\nexport const useCart = () => {\n  _s2();\n  return useContext(CartContext);\n};\n_s2(useCart, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","CartContext","jsxDEV","_jsxDEV","CartProvider","children","_s","cartItems","setCartItems","loading","setLoading","fetchCart","res","fetch","headers","localStorage","getItem","data","json","items","err","console","error","addToCart","item","qty","prev","existing","find","i","product","_id","productId","variant","color","size","map","quantity","method","body","JSON","stringify","image","price","success","message","removeFromCart","log","qunatity","cart","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useCart","_s2","$RefreshReg$"],"sources":["C:/Users/91600/Documents/zahidproject/frontend/src/context/cart/CartState.js"],"sourcesContent":["\r\nimport React, { createContext, useContext, useState, useEffect } from \"react\";\r\n\r\nimport CartContext from \"./CartContext\";\r\n\r\nexport const CartProvider = ({ children }) => {\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n\r\n  useEffect(() => {\r\n    fetchCart();\r\n  }, []);\r\n\r\n  const fetchCart = async () => {\r\n    try {\r\n      const res = await fetch(\"http://localhost:5000/api/cart/fetchcart\", {\r\n        headers: { \"auth-token\": localStorage.getItem(\"token\") },\r\n      });\r\n      const data = await res.json();\r\n      setCartItems(data.items || []);\r\n    } catch (err) {\r\n      console.error(err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const addToCart = async (item, qty) => {\r\n  try {\r\n    // Update frontend state immediately\r\n    setCartItems(prev => {\r\n      const existing = prev.find(\r\n        i =>\r\n          i.product._id === item.productId &&\r\n          i.variant.color === item.color &&\r\n          i.size === item.size\r\n      );\r\n\r\n      if (existing) {\r\n        return prev.map(i =>\r\n          i === existing ? { ...i, quantity: i.quantity + qty } : i\r\n        );\r\n      } else {\r\n        return [...prev, { ...item, quantity: qty }];\r\n      }\r\n    });\r\n\r\n    // Send backend request to persist\r\n    const res = await fetch(\"http://localhost:5000/api/cart/addcart\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"auth-token\": localStorage.getItem(\"token\"),\r\n      },\r\n      body: JSON.stringify({\r\n        productId: item.productId,\r\n        color: item.color,\r\n        size: item.size,\r\n        image: item.image,\r\n        price: item.price,\r\n        quantity: qty,\r\n      }),\r\n    });\r\n\r\n    const data = await res.json();\r\n\r\n    if (!data.success) {\r\n      console.error(\"Failed to add to cart:\", data.message);\r\n      // Optionally revert state if backend fails\r\n    }\r\n  } catch (err) {\r\n    console.error(err);\r\n  }\r\n};\r\n\r\n const removeFromCart = async (item ) => {\r\n    console.log( item.product._id,item.variant.color, item.size);\r\n    try {\r\n      const res = await fetch(\"http://localhost:5000/api/cart/removecart\", {\r\n        method: \"DELETE\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          \"auth-token\": localStorage.getItem(\"token\"),\r\n        },\r\n          body: JSON.stringify({\r\n        productId: item.product._id,  \r\n        color: item.variant.color,\r\n        size: item.size,\r\n        quantity:item.qunatity\r\n      }),\r\n   \r\n\r\n      });\r\n      const data = await res.json();\r\n      if (data.success) {\r\n        setCartItems(data.cart.items); \r\n      }\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n \r\n  return (\r\n    <CartContext.Provider\r\n      value={{ cartItems, setCartItems, loading, addToCart,removeFromCart  }}\r\n    >\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useCart = () => useContext(CartContext);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}